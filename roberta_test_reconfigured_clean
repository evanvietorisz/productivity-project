{"cells":[{"cell_type":"markdown","source":["# Fine Tuning a roBERTa model"],"metadata":{"id":"e_VqYvqOBEs6"}},{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":236,"status":"ok","timestamp":1692332608896,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"},"user_tz":240},"id":"5_e0-rwAd22e","outputId":"6563a744-801d-499f-ee38-0d0e21ba3f11"},"outputs":[{"output_type":"stream","name":"stdout","text":["Fri Aug 18 04:23:28 2023       \n","+-----------------------------------------------------------------------------+\n","| NVIDIA-SMI 525.105.17   Driver Version: 525.105.17   CUDA Version: 12.0     |\n","|-------------------------------+----------------------+----------------------+\n","| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |\n","| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |\n","|                               |                      |               MIG M. |\n","|===============================+======================+======================|\n","|   0  Tesla T4            Off  | 00000000:00:04.0 Off |                    0 |\n","| N/A   34C    P8     9W /  70W |      0MiB / 15360MiB |      0%      Default |\n","|                               |                      |                  N/A |\n","+-------------------------------+----------------------+----------------------+\n","                                                                               \n","+-----------------------------------------------------------------------------+\n","| Processes:                                                                  |\n","|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |\n","|        ID   ID                                                   Usage      |\n","|=============================================================================|\n","|  No running processes found                                                 |\n","+-----------------------------------------------------------------------------+\n"]}],"source":["!nvidia-smi"]},{"cell_type":"markdown","metadata":{"id":"hXnkQSWWJ5dE"},"source":["# Imports"]},{"cell_type":"code","execution_count":2,"metadata":{"id":"zh8fsBTEmlSd","executionInfo":{"status":"ok","timestamp":1692332636752,"user_tz":240,"elapsed":19298,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"}}},"outputs":[],"source":["%%capture\n","!pip install transformers\n","!pip install pytorch-lightning\n"]},{"cell_type":"code","execution_count":3,"metadata":{"id":"j2KxatsLqQsd","executionInfo":{"status":"ok","timestamp":1692332636944,"user_tz":240,"elapsed":195,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"}}},"outputs":[],"source":["import os\n","import numpy as np\n","import pandas as pd\n","import matplotlib.pyplot as plt\n","from google.colab import drive"]},{"cell_type":"code","execution_count":5,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1160,"status":"ok","timestamp":1692332713834,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"},"user_tz":240},"id":"DFR7fLLLBbrh","outputId":"782194b2-c317-4e5f-fe63-81db4ed7587d"},"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}],"source":["drive.mount('/content/drive', force_remount=False)"]},{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"w0-aKjRf5BCr","executionInfo":{"status":"ok","timestamp":1692332729709,"user_tz":240,"elapsed":1246,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"}},"outputId":"fdcaf2f5-d474-40fe-89eb-fe57f8e93e81"},"execution_count":6,"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}]},{"cell_type":"code","execution_count":7,"metadata":{"id":"LYHit0GicSyU","executionInfo":{"status":"ok","timestamp":1692332825933,"user_tz":240,"elapsed":163,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"}}},"outputs":[],"source":["train_path = '/content/drive/MyDrive/Cotera/train_trial.csv'\n","val_path = '/content/drive/MyDrive/Cotera/val_trial.csv'"]},{"cell_type":"code","execution_count":8,"metadata":{"id":"_GMaDvSeoqBZ","executionInfo":{"status":"ok","timestamp":1692332829646,"user_tz":240,"elapsed":1035,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"}}},"outputs":[],"source":["train_data = pd.read_csv(train_path)"]},{"cell_type":"code","source":["train_data.head()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":206},"id":"8uEZZ3wR5gsr","executionInfo":{"status":"ok","timestamp":1692332861590,"user_tz":240,"elapsed":187,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"}},"outputId":"22509af5-a161-4186-df2c-ed58306ceb68"},"execution_count":9,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                                body  replied_to\n","0  Hi Saloni,  Acknowledging receipt. Thanks for ...           0\n","1  <html><head><meta http-equiv=\"content-type\" co...           1\n","2  Katie Lee (leekat@stanford.edu) mentioned you ...           0\n","3  Web Version:  http://taxbackcom.newsweaver.com...           0\n","4  You're invited!  http://digitaleconomy.stanfor...           0"],"text/html":["\n","  <div id=\"df-45b91a61-3f17-41d3-ad03-84617d48daba\" class=\"colab-df-container\">\n","    <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>body</th>\n","      <th>replied_to</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Hi Saloni,  Acknowledging receipt. Thanks for ...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>&lt;html&gt;&lt;head&gt;&lt;meta http-equiv=\"content-type\" co...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Katie Lee (leekat@stanford.edu) mentioned you ...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Web Version:  http://taxbackcom.newsweaver.com...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>You're invited!  http://digitaleconomy.stanfor...</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","    <div class=\"colab-df-buttons\">\n","\n","  <div class=\"colab-df-container\">\n","    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-45b91a61-3f17-41d3-ad03-84617d48daba')\"\n","            title=\"Convert this dataframe to an interactive table.\"\n","            style=\"display:none;\">\n","\n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n","    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n","  </svg>\n","    </button>\n","\n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    .colab-df-buttons div {\n","      margin-bottom: 4px;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","    <script>\n","      const buttonEl =\n","        document.querySelector('#df-45b91a61-3f17-41d3-ad03-84617d48daba button.colab-df-convert');\n","      buttonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","      async function convertToInteractive(key) {\n","        const element = document.querySelector('#df-45b91a61-3f17-41d3-ad03-84617d48daba');\n","        const dataTable =\n","          await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                    [key], {});\n","        if (!dataTable) return;\n","\n","        const docLinkHtml = 'Like what you see? Visit the ' +\n","          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","          + ' to learn more about interactive tables.';\n","        element.innerHTML = '';\n","        dataTable['output_type'] = 'display_data';\n","        await google.colab.output.renderOutput(dataTable, element);\n","        const docLink = document.createElement('div');\n","        docLink.innerHTML = docLinkHtml;\n","        element.appendChild(docLink);\n","      }\n","    </script>\n","  </div>\n","\n","\n","<div id=\"df-0e233531-d538-4245-951d-5014e950c1b2\">\n","  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-0e233531-d538-4245-951d-5014e950c1b2')\"\n","            title=\"Suggest charts.\"\n","            style=\"display:none;\">\n","\n","<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","     width=\"24px\">\n","    <g>\n","        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n","    </g>\n","</svg>\n","  </button>\n","\n","<style>\n","  .colab-df-quickchart {\n","    background-color: #E8F0FE;\n","    border: none;\n","    border-radius: 50%;\n","    cursor: pointer;\n","    display: none;\n","    fill: #1967D2;\n","    height: 32px;\n","    padding: 0 0 0 0;\n","    width: 32px;\n","  }\n","\n","  .colab-df-quickchart:hover {\n","    background-color: #E2EBFA;\n","    box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","    fill: #174EA6;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart {\n","    background-color: #3B4455;\n","    fill: #D2E3FC;\n","  }\n","\n","  [theme=dark] .colab-df-quickchart:hover {\n","    background-color: #434B5C;\n","    box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","    filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","    fill: #FFFFFF;\n","  }\n","</style>\n","\n","  <script>\n","    async function quickchart(key) {\n","      const charts = await google.colab.kernel.invokeFunction(\n","          'suggestCharts', [key], {});\n","    }\n","    (() => {\n","      let quickchartButtonEl =\n","        document.querySelector('#df-0e233531-d538-4245-951d-5014e950c1b2 button');\n","      quickchartButtonEl.style.display =\n","        google.colab.kernel.accessAllowed ? 'block' : 'none';\n","    })();\n","  </script>\n","</div>\n","    </div>\n","  </div>\n"]},"metadata":{},"execution_count":9}]},{"cell_type":"markdown","metadata":{"id":"GDdLgBECpnJ8"},"source":["# inspect data"]},{"cell_type":"code","execution_count":12,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":469},"executionInfo":{"elapsed":350,"status":"ok","timestamp":1692332930198,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"},"user_tz":240},"id":"aN6M-KaApoRo","outputId":"bef12409-89da-403d-8ac0-fc2f7ec68e37"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[<Axes: title={'center': 'replied_to'}>]], dtype=object)"]},"metadata":{},"execution_count":12},{"output_type":"display_data","data":{"text/plain":["<Figure size 640x480 with 1 Axes>"],"image/png":"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\n"},"metadata":{}}],"source":["attributes = ['replied_to']\n","\n","train_data[attributes].hist()"]},{"cell_type":"markdown","metadata":{"id":"ECq7VkvoqR4Q"},"source":["# Dataset"]},{"cell_type":"code","execution_count":13,"metadata":{"id":"OHYq_l9vqSs_","executionInfo":{"status":"ok","timestamp":1692332937919,"user_tz":240,"elapsed":4653,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"}}},"outputs":[],"source":["from torch.utils.data import Dataset"]},{"cell_type":"code","execution_count":16,"metadata":{"id":"WuDSi08sqVYe","executionInfo":{"status":"ok","timestamp":1692333278247,"user_tz":240,"elapsed":166,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"}}},"outputs":[],"source":["class Email_Dataset(Dataset):\n","\n","  def __init__(self, data_path, tokenizer, attributes, max_token_len: int = 128, sample = None):\n","    self.data_path = data_path\n","    self.tokenizer = tokenizer\n","    self.attributes = attributes\n","    self.max_token_len = max_token_len\n","    self.sample = sample\n","    self._prepare_data()\n","\n","\n","  def _prepare_data(self):\n","    data = pd.read_csv(self.data_path)\n","    #data['unhealthy'] = np.where(data['healthy'] == 1, 0, 1)\n","    if self.sample is not None:\n","      # unhealthy = data.loc[data[attributes].sum(axis=1) > 0]\n","      # clean = data.loc[data[attributes].sum(axis=1) == 0]\n","      # self.data = pd.concat([unhealthy, clean.sample(self.sample, random_state=7)])\n","      self.data = data\n","    else:\n","      self.data = data\n","\n","  def __len__(self):\n","    return len(self.data)\n","\n","  def __getitem__(self, index):\n","    item = self.data.iloc[index]\n","    comment = str(item.body)#changed this\n","    attributes = torch.FloatTensor(item[self.attributes])\n","    tokens = self.tokenizer.encode_plus(comment,\n","                                        add_special_tokens=True,\n","                                        return_tensors='pt',\n","                                        truncation=True,\n","                                        padding='max_length',\n","                                        max_length=self.max_token_len,\n","                                        return_attention_mask = True)\n","    return {'input_ids': tokens.input_ids.flatten(), 'attention_mask': tokens.attention_mask.flatten(), 'labels': attributes}\n"]},{"cell_type":"code","execution_count":17,"metadata":{"executionInfo":{"elapsed":1078,"status":"ok","timestamp":1692333285838,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"},"user_tz":240},"id":"N5TfbQjBrshN"},"outputs":[],"source":["import torch\n","from transformers import AutoTokenizer\n","model_name = 'roberta-base'\n","tokenizer = AutoTokenizer.from_pretrained(model_name)\n","email_ds = Email_Dataset(train_path, tokenizer, attributes=attributes)\n","email_ds_val = Email_Dataset(val_path, tokenizer, attributes=attributes, sample=None)"]},{"cell_type":"code","execution_count":19,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":154,"status":"ok","timestamp":1692333305280,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"},"user_tz":240},"id":"AxG1q2R5sKe9","outputId":"a92d3806-3829-4db0-bc1e-b877e0502b01"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(torch.Size([1]), torch.Size([128]), torch.Size([128]))"]},"metadata":{},"execution_count":19}],"source":["email_ds.__getitem__(0)['labels'].shape, email_ds.__getitem__(0)['input_ids'].shape, email_ds.__getitem__(0)['attention_mask'].shape"]},{"cell_type":"code","execution_count":21,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":3,"status":"ok","timestamp":1692333311223,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"},"user_tz":240},"id":"E3piF8-ScLkB","outputId":"96ad2a7a-575a-42c4-a2dc-4454da4d3cd2"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["5650"]},"metadata":{},"execution_count":21}],"source":["len(email_ds)"]},{"cell_type":"code","execution_count":20,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":165,"status":"ok","timestamp":1692333310279,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"},"user_tz":240},"id":"vdnNmd2ScreK","outputId":"bddd4993-49a0-4431-b7b4-8ada1a8440d0"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["1413"]},"metadata":{},"execution_count":20}],"source":["len(email_ds_val)"]},{"cell_type":"markdown","metadata":{"id":"gUr-j36ctWH-"},"source":["# Data module"]},{"cell_type":"code","execution_count":22,"metadata":{"id":"fdPf54AatXaX","executionInfo":{"status":"ok","timestamp":1692333317114,"user_tz":240,"elapsed":2576,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"}}},"outputs":[],"source":["import pytorch_lightning as pl\n","from torch.utils.data import DataLoader"]},{"cell_type":"code","execution_count":23,"metadata":{"id":"k7PxkuevtkpS","executionInfo":{"status":"ok","timestamp":1692333410172,"user_tz":240,"elapsed":138,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"}}},"outputs":[],"source":["class Email_Data_Module(pl.LightningDataModule):\n","\n","  def __init__(self, train_path, val_path, attributes, batch_size: int = 16, max_token_length: int = 128,  model_name='roberta-base'):\n","    super().__init__()\n","    self.train_path = train_path\n","    self.val_path = val_path\n","    self.attributes = attributes\n","    self.batch_size = batch_size\n","    self.max_token_length = max_token_length\n","    self.model_name = model_name\n","    self.tokenizer = AutoTokenizer.from_pretrained(model_name)\n","\n","  def setup(self, stage = None):\n","    if stage in (None, \"fit\"):\n","      self.train_dataset = Email_Dataset(self.train_path, attributes=self.attributes, tokenizer=self.tokenizer)\n","      self.val_dataset = Email_Dataset(self.val_path, attributes=self.attributes, tokenizer=self.tokenizer, sample=None)\n","    if stage == 'predict':\n","      self.val_dataset = Email_Dataset(self.val_path, attributes=self.attributes, tokenizer=self.tokenizer, sample=None)\n","\n","  def train_dataloader(self):\n","    return DataLoader(self.train_dataset, batch_size = self.batch_size, num_workers=4, shuffle=True)\n","\n","  def val_dataloader(self):\n","    return DataLoader(self.val_dataset, batch_size = self.batch_size, num_workers=4, shuffle=False)\n","\n","  def predict_dataloader(self):\n","    return DataLoader(self.val_dataset, batch_size = self.batch_size, num_workers=4, shuffle=False)\n"]},{"cell_type":"code","execution_count":24,"metadata":{"id":"weSlOGEsvB0j","executionInfo":{"status":"ok","timestamp":1692333429892,"user_tz":240,"elapsed":325,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"}}},"outputs":[],"source":["email_data_module = Email_Data_Module(train_path, val_path, attributes=attributes)"]},{"cell_type":"code","execution_count":25,"metadata":{"id":"oMSwVVq_vJPQ","executionInfo":{"status":"ok","timestamp":1692333433611,"user_tz":240,"elapsed":577,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"}}},"outputs":[],"source":["email_data_module.setup()"]},{"cell_type":"code","execution_count":26,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":3,"status":"ok","timestamp":1692333441976,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"},"user_tz":240},"id":"unF1JP_hvMnq","outputId":"cf77cdbd-ee8a-44dc-d372-69c159cc999c"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["<torch.utils.data.dataloader.DataLoader at 0x794f6bbbc670>"]},"metadata":{},"execution_count":26}],"source":["email_data_module.train_dataloader()"]},{"cell_type":"code","execution_count":27,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":3,"status":"ok","timestamp":1692333446994,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"},"user_tz":240},"id":"kCBaHGBsvQaw","outputId":"786be67c-f6b4-4fb2-a20f-aeb62cdff055"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["354"]},"metadata":{},"execution_count":27}],"source":["len(email_data_module.train_dataloader())"]},{"cell_type":"markdown","metadata":{"id":"as2bbkWmwFO1"},"source":["# Model"]},{"cell_type":"code","execution_count":28,"metadata":{"id":"pJ7T-xtnwGpw","executionInfo":{"status":"ok","timestamp":1692333455140,"user_tz":240,"elapsed":4409,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"}}},"outputs":[],"source":["from transformers import AutoModel, AdamW, get_cosine_schedule_with_warmup\n","import torch.nn as nn\n","import math\n","from torchmetrics.functional.classification import auroc\n","import torch.nn.functional as F"]},{"cell_type":"code","execution_count":31,"metadata":{"id":"xeLW6BYUwUTu","executionInfo":{"status":"ok","timestamp":1692333726508,"user_tz":240,"elapsed":245,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"}}},"outputs":[],"source":["class Email_Classifier(pl.LightningModule):\n","\n","  def __init__(self, config: dict):\n","    super().__init__()\n","    self.config = config\n","    self.pretrained_model = AutoModel.from_pretrained(config['model_name'], return_dict = True)\n","    self.hidden = torch.nn.Linear(self.pretrained_model.config.hidden_size, self.pretrained_model.config.hidden_size)\n","    self.dropout = nn.Dropout()\n","    self.classifier = torch.nn.Linear(self.pretrained_model.config.hidden_size, self.config['n_labels'])\n","    torch.nn.init.xavier_uniform_(self.classifier.weight)\n","    torch.nn.init.xavier_uniform_(self.hidden.weight)\n","    self.loss_func = nn.BCEWithLogitsLoss(reduction='mean')\n","\n","\n","  def forward(self, input_ids, attention_mask, labels=None):\n","    # roberta layer\n","    output = self.pretrained_model(input_ids=input_ids, attention_mask=attention_mask)\n","    pooled_output = torch.mean(output.last_hidden_state, 1)\n","    # final logits\n","    pooled_output = self.dropout(pooled_output)\n","    pooled_output = self.hidden(pooled_output)\n","    pooled_output = F.relu(pooled_output)\n","    pooled_output = self.dropout(pooled_output)\n","    logits = self.classifier(pooled_output)\n","    # calculate loss\n","    loss = 0\n","    if labels is not None:\n","      loss = self.loss_func(logits.view(-1, self.config['n_labels']), labels.view(-1, self.config['n_labels']))\n","    return loss, logits\n","\n","  def training_step(self, batch, batch_index):\n","    loss, outputs = self(**batch)\n","    self.log(\"train loss \", loss, prog_bar = True, logger=True)\n","    return {\"loss\":loss, \"predictions\":outputs, \"labels\": batch[\"labels\"]}\n","\n","  def validation_step(self, batch, batch_index):\n","    loss, outputs = self(**batch)\n","    self.log(\"validation loss \", loss, prog_bar = True, logger=True)\n","    return {\"val_loss\": loss, \"predictions\":outputs, \"labels\": batch[\"labels\"]}\n","\n","  def predict_step(self, batch, batch_index):\n","    loss, outputs = self(**batch)\n","    return outputs\n","\n","  def configure_optimizers(self):\n","    optimizer = AdamW(self.parameters(), lr=self.config['lr'], weight_decay=self.config['weight_decay'])\n","    total_steps = self.config['train_size']/self.config['batch_size']\n","    warmup_steps = math.floor(total_steps * self.config['warmup'])\n","    warmup_steps = math.floor(total_steps * self.config['warmup'])\n","    scheduler = get_cosine_schedule_with_warmup(optimizer, warmup_steps, total_steps)\n","    return [optimizer],[scheduler]\n","\n","  # def validation_epoch_end(self, outputs):\n","  #   losses = []\n","  #   for output in outputs:\n","  #     loss = output['val_loss'].detach().cpu()\n","  #     losses.append(loss)\n","  #   avg_loss = torch.mean(torch.stack(losses))\n","  #   self.log(\"avg_val_loss\", avg_loss)\n"]},{"cell_type":"code","execution_count":33,"metadata":{"executionInfo":{"elapsed":987,"status":"ok","timestamp":1692333739162,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"},"user_tz":240},"id":"ioZPU0CCziRN"},"outputs":[],"source":["config = {\n","    'model_name': 'distilroberta-base',\n","    'n_labels': len(attributes),\n","    'batch_size': 128,\n","    'lr': 1.5e-6,\n","    'warmup': 0.2,\n","    'train_size': len(email_data_module.train_dataloader()),\n","    'weight_decay': 0.001,\n","    'n_epochs': 1\n","}\n","\n","model = Email_Classifier(config)"]},{"cell_type":"code","execution_count":34,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":680,"status":"ok","timestamp":1692333828951,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"},"user_tz":240},"id":"o0KK_ffoz_dx","outputId":"6abbec53-3594-4edc-cf99-9c051b9ed69a"},"outputs":[{"output_type":"stream","name":"stdout","text":["torch.Size([1]) torch.Size([1, 1]) tensor([[-0.9370]], grad_fn=<AddmmBackward0>)\n"]}],"source":["idx=0\n","input_ids = email_ds.__getitem__(idx)['input_ids']\n","attention_mask = email_ds.__getitem__(idx)['attention_mask']\n","labels = email_ds.__getitem__(idx)['labels']\n","model.cpu() #NOTE THIS\n","loss, output = model(input_ids.unsqueeze(dim=0), attention_mask.unsqueeze(dim=0), labels.unsqueeze(dim=0))\n","print(labels.shape, output.shape, output)"]},{"cell_type":"markdown","metadata":{"id":"pOeSkQmg06M0"},"source":[" # train model"]},{"cell_type":"code","execution_count":37,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":486,"referenced_widgets":["e7c6d72f2aa54e71a28388c9beff64b3","9649c8766111420f88c8840dc52be608","fe8250c8c1674030bad437c7eb0fe7e7","75f62ec6b9554b37a7441a6d5a5f3db6","293cbfa65bb540f1985b6efff70eec22","722f977000a743faa103d6bd9cb04346","10f7c234594d41b3bfd09a03bebf98cc","74f81522d27f4597b939e0c4d85593f1","8167075c610d49d18f7b79dd43be7251","345345467f7b4fa592f47aa3f5d3701f","7096da36494946c283da62d9259b4029","39f499a4b4b94fcab99d790d9f31b396","a414fe555e58416fb982fc3636463b93","55c50e4277a440ac97b615bbe29535d7","005608381c7a431486c3231b6b64df25","0263d183cd784c748378c9188ac8b359","e6760f44abe84c2391d9eea7a14ba5c7","ce46c545554e4443a46768294839bbd9","ff9c3774b6e6454cbd958533bcde7a4a","ec6d910ba158428ca5fd33b6b77c0b1c","a226891eb5f345b1a11e436c7a7429bd","6185a18253c84c68b3e080914f8cc179","537c777c762a4fcda6b76ac10749292a","eef1415edd304f02bf3ea12ab9fe4041","22ae95a1020f4455add80b13b9801b7b","3eb8e4a3e0cd4531872a24659bc4f6ff","122a3a0067e749ecb6f2cb2a619ccb06","daa6bad797454be2b7bc56993fe5720c","0a76ffc8a6164bb1a848dc62472ba881","9e0883267bee48ff9b30584d7ad9ff10","100d77803cf3451095d730b331bc15b7","d112d3e4babe4233b2191aa0a8d60452","18361b0936c9445a8882e50affeb54a7"]},"id":"SYNN5lgq07sd","executionInfo":{"status":"ok","timestamp":1692334112500,"user_tz":240,"elapsed":74996,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"}},"outputId":"3b56ca7a-b60e-425d-efdb-829fc92e33a7"},"outputs":[{"output_type":"stream","name":"stderr","text":["INFO:pytorch_lightning.utilities.rank_zero:GPU available: True (cuda), used: True\n","INFO:pytorch_lightning.utilities.rank_zero:TPU available: False, using: 0 TPU cores\n","INFO:pytorch_lightning.utilities.rank_zero:IPU available: False, using: 0 IPUs\n","INFO:pytorch_lightning.utilities.rank_zero:HPU available: False, using: 0 HPUs\n","WARNING:pytorch_lightning.loggers.tensorboard:Missing logger folder: /content/lightning_logs\n","INFO:pytorch_lightning.accelerators.cuda:LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]\n","/usr/local/lib/python3.10/dist-packages/transformers/optimization.py:411: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning\n","  warnings.warn(\n","INFO:pytorch_lightning.callbacks.model_summary:\n","  | Name             | Type              | Params\n","-------------------------------------------------------\n","0 | pretrained_model | RobertaModel      | 82.1 M\n","1 | hidden           | Linear            | 590 K \n","2 | dropout          | Dropout           | 0     \n","3 | classifier       | Linear            | 769   \n","4 | loss_func        | BCEWithLogitsLoss | 0     \n","-------------------------------------------------------\n","82.7 M    Trainable params\n","0         Non-trainable params\n","82.7 M    Total params\n","330.839   Total estimated model params size (MB)\n"]},{"output_type":"display_data","data":{"text/plain":["Sanity Checking: 0it [00:00, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"e7c6d72f2aa54e71a28388c9beff64b3"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.10/dist-packages/pytorch_lightning/loops/fit_loop.py:281: PossibleUserWarning: The number of training batches (45) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.\n","  rank_zero_warn(\n"]},{"output_type":"display_data","data":{"text/plain":["Training: 0it [00:00, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"39f499a4b4b94fcab99d790d9f31b396"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Validation: 0it [00:00, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"537c777c762a4fcda6b76ac10749292a"}},"metadata":{}},{"output_type":"stream","name":"stderr","text":["INFO:pytorch_lightning.utilities.rank_zero:`Trainer.fit` stopped: `max_epochs=1` reached.\n"]}],"source":["# datamodule\n","email_data_module = Email_Data_Module(train_path, val_path, attributes=attributes, batch_size=config['batch_size'])\n","email_data_module.setup()\n","\n","# model\n","model = Email_Classifier(config)\n","\n","# trainer and fit\n","trainer = pl.Trainer(max_epochs=config['n_epochs'], devices=1, accelerator='gpu', num_sanity_val_steps=50)\n","trainer.fit(model, email_data_module)\n"]},{"cell_type":"code","execution_count":null,"metadata":{"id":"nt7e_jxh1O1_"},"outputs":[],"source":["#TODO install dependency markupsafe\n","%load_ext tensorboard\n","%tensorboard --logdir ./lightning_logs/"]},{"cell_type":"markdown","metadata":{"id":"JIfqDeMPOp8q"},"source":["# Predict with model"]},{"cell_type":"code","execution_count":43,"metadata":{"id":"nU7ylR8lZZta","executionInfo":{"status":"ok","timestamp":1692334255393,"user_tz":240,"elapsed":171,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"}}},"outputs":[],"source":["# method to convert list of comments into predictions for each comment\n","def classify_emails(model, dm):\n","  predictions = trainer.predict(model, datamodule=dm)\n","  flattened_predictions = np.stack([torch.sigmoid(torch.Tensor(p)) for batch in predictions for p in batch])\n","  return flattened_predictions"]},{"cell_type":"code","execution_count":48,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":66,"referenced_widgets":["aaab3ffc548e482bb149d91ac4cf9beb","cbda2f4962de4f9c86032e36036295ee","110e8d9260e34ff4be30531e35c12beb","62adc4560b17455996a3fd6bcedecbd4","ee7b3f4163824f67baaaa9453baa143b","61a367ba5e814d7199b36e1d4ec9cb67","febc2e651f194901b6efcbd4dab5fbd0","24b4b02640df4b308d52253afacb6f1c","51be3aabbfb94bc3ba990f1a4ad0fb84","4b7c76e29e584fd1a0d8d254baa697bb","6b53b2dc37d648dc9577f7dafba5e464"]},"id":"zV65QbMOZ5aU","executionInfo":{"status":"ok","timestamp":1692334707255,"user_tz":240,"elapsed":7908,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"}},"outputId":"96fe70ef-ae3e-48c5-e911-3cd200150a21"},"outputs":[{"output_type":"stream","name":"stderr","text":["INFO:pytorch_lightning.accelerators.cuda:LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]\n"]},{"output_type":"display_data","data":{"text/plain":["Predicting: 0it [00:00, ?it/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"aaab3ffc548e482bb149d91ac4cf9beb"}},"metadata":{}}],"source":["y_raw_outputs = classify_emails(model, email_data_module)\n","y_pred = np.round(y_raw_outputs)"]},{"cell_type":"code","execution_count":51,"metadata":{"id":"t04aYi5GaFsv","executionInfo":{"status":"ok","timestamp":1692334716099,"user_tz":240,"elapsed":176,"user":{"displayName":"Evan Vietorisz","userId":"05293804911208550031"}}},"outputs":[],"source":["val_data = pd.read_csv(val_path)\n","y_true = np.array(val_data[attributes])"]},{"cell_type":"code","source":["from sklearn import metrics\n","import matplotlib.pyplot as plt\n","import seaborn as sns\n","\n","fig_title = \"Nearly out-of-the-box model on binary dataset (1 epoch)\"\n","\n","cnf_matrix = metrics.confusion_matrix(y_true, y_pred)\n","\n","fpr, tpr, _ = metrics.roc_curve(y_true, y_raw_outputs)\n","auc = metrics.auc(fpr, tpr)\n","\n","target_names=['not replied to', 'replied to']\n","report = metrics.classification_report(y_true, y_pred, target_names=target_names)\n","accuracy = report.split('accuracy')[1].lstrip()[:4]\n","\n","\n","fig, ax = plt.subplots(1,2, figsize=(15,7))\n","fig.suptitle(fig_title)\n","\n","sns.heatmap(cnf_matrix, annot=True, fmt='d', ax=ax[0])\n","ax[0].set_title('Confusion Matrix (Accuracy = {})'.format(accuracy))\n","ax[0].set_xlabel('Predicted')\n","ax[0].set_ylabel('Actual')\n","\n","ax[1].plot(fpr,tpr)\n","ax[1].set_title('ROC Curve (AUC = {:.2f})'.format(auc))\n","ax[1].set_xlabel('false positive rate')\n","ax[1].set_ylabel('true positive rate')\n","\n","plt.show()"],"metadata":{"id":"S0iOiwAy4nhe"},"execution_count":null,"outputs":[]}],"metadata":{"accelerator":"GPU","colab":{"machine_shape":"hm","provenance":[{"file_id":"1ejBYmu0P5urzghoTTDB-GBUxpbUFX0Gz","timestamp":1692332414263},{"file_id":"1LrQMs7uBf7xUlVW3OCKHB0sceAQC7oN6","timestamp":1638388210172}]},"kernelspec":{"display_name":"Python 3","name":"python3"},"widgets":{"application/vnd.jupyter.widget-state+json":{"e7c6d72f2aa54e71a28388c9beff64b3":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_9649c8766111420f88c8840dc52be608","IPY_MODEL_fe8250c8c1674030bad437c7eb0fe7e7","IPY_MODEL_75f62ec6b9554b37a7441a6d5a5f3db6"],"layout":"IPY_MODEL_293cbfa65bb540f1985b6efff70eec22"}},"9649c8766111420f88c8840dc52be608":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_722f977000a743faa103d6bd9cb04346","placeholder":"​","style":"IPY_MODEL_10f7c234594d41b3bfd09a03bebf98cc","value":"Sanity Checking DataLoader 0: 100%"}},"fe8250c8c1674030bad437c7eb0fe7e7":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_74f81522d27f4597b939e0c4d85593f1","max":12,"min":0,"orientation":"horizontal","style":"IPY_MODEL_8167075c610d49d18f7b79dd43be7251","value":12}},"75f62ec6b9554b37a7441a6d5a5f3db6":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_345345467f7b4fa592f47aa3f5d3701f","placeholder":"​","style":"IPY_MODEL_7096da36494946c283da62d9259b4029","value":" 12/12 [00:05&lt;00:00,  2.32it/s]"}},"293cbfa65bb540f1985b6efff70eec22":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":"inline-flex","flex":null,"flex_flow":"row wrap","grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":"100%"}},"722f977000a743faa103d6bd9cb04346":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"10f7c234594d41b3bfd09a03bebf98cc":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"74f81522d27f4597b939e0c4d85593f1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":"2","flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"8167075c610d49d18f7b79dd43be7251":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"345345467f7b4fa592f47aa3f5d3701f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"7096da36494946c283da62d9259b4029":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"39f499a4b4b94fcab99d790d9f31b396":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_a414fe555e58416fb982fc3636463b93","IPY_MODEL_55c50e4277a440ac97b615bbe29535d7","IPY_MODEL_005608381c7a431486c3231b6b64df25"],"layout":"IPY_MODEL_0263d183cd784c748378c9188ac8b359"}},"a414fe555e58416fb982fc3636463b93":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_e6760f44abe84c2391d9eea7a14ba5c7","placeholder":"​","style":"IPY_MODEL_ce46c545554e4443a46768294839bbd9","value":"Epoch 0: 100%"}},"55c50e4277a440ac97b615bbe29535d7":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_ff9c3774b6e6454cbd958533bcde7a4a","max":45,"min":0,"orientation":"horizontal","style":"IPY_MODEL_ec6d910ba158428ca5fd33b6b77c0b1c","value":45}},"005608381c7a431486c3231b6b64df25":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_a226891eb5f345b1a11e436c7a7429bd","placeholder":"​","style":"IPY_MODEL_6185a18253c84c68b3e080914f8cc179","value":" 45/45 [01:02&lt;00:00,  1.39s/it, v_num=0, train loss =0.521, validation loss =0.572]"}},"0263d183cd784c748378c9188ac8b359":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":"inline-flex","flex":null,"flex_flow":"row wrap","grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"100%"}},"e6760f44abe84c2391d9eea7a14ba5c7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ce46c545554e4443a46768294839bbd9":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"ff9c3774b6e6454cbd958533bcde7a4a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":"2","flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"ec6d910ba158428ca5fd33b6b77c0b1c":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"a226891eb5f345b1a11e436c7a7429bd":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6185a18253c84c68b3e080914f8cc179":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"537c777c762a4fcda6b76ac10749292a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_eef1415edd304f02bf3ea12ab9fe4041","IPY_MODEL_22ae95a1020f4455add80b13b9801b7b","IPY_MODEL_3eb8e4a3e0cd4531872a24659bc4f6ff"],"layout":"IPY_MODEL_122a3a0067e749ecb6f2cb2a619ccb06"}},"eef1415edd304f02bf3ea12ab9fe4041":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_daa6bad797454be2b7bc56993fe5720c","placeholder":"​","style":"IPY_MODEL_0a76ffc8a6164bb1a848dc62472ba881","value":"Validation DataLoader 0: 100%"}},"22ae95a1020f4455add80b13b9801b7b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"","description":"","description_tooltip":null,"layout":"IPY_MODEL_9e0883267bee48ff9b30584d7ad9ff10","max":12,"min":0,"orientation":"horizontal","style":"IPY_MODEL_100d77803cf3451095d730b331bc15b7","value":12}},"3eb8e4a3e0cd4531872a24659bc4f6ff":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d112d3e4babe4233b2191aa0a8d60452","placeholder":"​","style":"IPY_MODEL_18361b0936c9445a8882e50affeb54a7","value":" 12/12 [00:03&lt;00:00,  3.21it/s]"}},"122a3a0067e749ecb6f2cb2a619ccb06":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":"inline-flex","flex":null,"flex_flow":"row wrap","grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":"hidden","width":"100%"}},"daa6bad797454be2b7bc56993fe5720c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"0a76ffc8a6164bb1a848dc62472ba881":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"9e0883267bee48ff9b30584d7ad9ff10":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":"2","flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"100d77803cf3451095d730b331bc15b7":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"d112d3e4babe4233b2191aa0a8d60452":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"18361b0936c9445a8882e50affeb54a7":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"aaab3ffc548e482bb149d91ac4cf9beb":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_cbda2f4962de4f9c86032e36036295ee","IPY_MODEL_110e8d9260e34ff4be30531e35c12beb","IPY_MODEL_62adc4560b17455996a3fd6bcedecbd4"],"layout":"IPY_MODEL_ee7b3f4163824f67baaaa9453baa143b"}},"cbda2f4962de4f9c86032e36036295ee":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_61a367ba5e814d7199b36e1d4ec9cb67","placeholder":"​","style":"IPY_MODEL_febc2e651f194901b6efcbd4dab5fbd0","value":"Predicting DataLoader 0: 100%"}},"110e8d9260e34ff4be30531e35c12beb":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_24b4b02640df4b308d52253afacb6f1c","max":12,"min":0,"orientation":"horizontal","style":"IPY_MODEL_51be3aabbfb94bc3ba990f1a4ad0fb84","value":12}},"62adc4560b17455996a3fd6bcedecbd4":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_4b7c76e29e584fd1a0d8d254baa697bb","placeholder":"​","style":"IPY_MODEL_6b53b2dc37d648dc9577f7dafba5e464","value":" 12/12 [00:04&lt;00:00,  2.64it/s]"}},"ee7b3f4163824f67baaaa9453baa143b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":"inline-flex","flex":null,"flex_flow":"row wrap","grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":"100%"}},"61a367ba5e814d7199b36e1d4ec9cb67":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"febc2e651f194901b6efcbd4dab5fbd0":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"24b4b02640df4b308d52253afacb6f1c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":"2","flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"51be3aabbfb94bc3ba990f1a4ad0fb84":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"4b7c76e29e584fd1a0d8d254baa697bb":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"6b53b2dc37d648dc9577f7dafba5e464":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"nbformat":4,"nbformat_minor":0}